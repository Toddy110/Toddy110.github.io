{"meta":{"title":"Modesty.","subtitle":"Stay hungry, stay foolish","description":"","author":"ToddyN","url":"https://toddy110.github.io","root":"/"},"pages":[{"title":"404","date":"2025-09-19T06:04:56.000Z","updated":"2025-09-19T06:05:57.189Z","comments":true,"path":"404/index.html","permalink":"https://toddy110.github.io/404/index.html","excerpt":"","text":""},{"title":"categories","date":"2025-09-08T01:00:42.000Z","updated":"2025-09-08T01:01:33.000Z","comments":true,"path":"categories/index.html","permalink":"https://toddy110.github.io/categories/index.html","excerpt":"","text":""},{"title":"contact","date":"2025-09-19T06:47:51.000Z","updated":"2025-09-19T06:59:00.984Z","comments":true,"path":"contact/index.html","permalink":"https://toddy110.github.io/contact/index.html","excerpt":"","text":"æ¬¢è¿æ¥åˆ°æˆ‘çš„ç•™è¨€æ¿ï¼ åœ¨è¿™é‡Œï¼Œæ‚¨å¯ä»¥ï¼š ğŸ’¬ ç•™ä¸‹æ‚¨çš„æƒ³æ³•å’Œå»ºè®® ğŸ¤ ç”³è¯·å‹æƒ…é“¾æ¥ ğŸ“§ ä¸æˆ‘äº¤æµæŠ€æœ¯é—®é¢˜ ğŸ’¡ åˆ†äº«æœ‰è¶£çš„æƒ³æ³• è¯·åœ¨ä¸‹æ–¹è¯„è®ºåŒºç•™è¨€ï¼Œæˆ‘ä¼šå°½å¿«å›å¤ï¼"},{"title":"tags","date":"2025-09-08T01:05:16.000Z","updated":"2025-09-08T01:06:40.000Z","comments":true,"path":"tags/index.html","permalink":"https://toddy110.github.io/tags/index.html","excerpt":"","text":""}],"posts":[{"title":"CNNåŸºç¡€","slug":"CNNåŸºç¡€","date":"2025-10-01T04:50:12.000Z","updated":"2025-10-01T05:46:40.207Z","comments":true,"path":"2025/10/01/CNNåŸºç¡€/","permalink":"https://toddy110.github.io/2025/10/01/CNN%E5%9F%BA%E7%A1%80/","excerpt":"","text":"CNN (Convolutional Neural Network, å·ç§¯ç¥ç»ç½‘ç»œ)ï¼ˆåŸºç¡€ï¼‰ 1. å›¾åƒåŸºç¡€ä¸æœ¬è´¨1.1 å›¾åƒçš„è¾“å…¥ç»“æ„ä»¥MNISTæ•°æ®é›†ä¸ºä¾‹ï¼Œç°åº¦å›¾åƒçš„è¾“å…¥å°ºå¯¸ä¸º 1Ã—28Ã—281 \\times 28 \\times 281Ã—28Ã—28ï¼Œå³ï¼š é€šé“æ•°ï¼ˆChannelï¼‰ï¼š1ï¼Œè¡¨ç¤ºç°åº¦å›¾åƒåªæœ‰ä¸€ä¸ªé¢œè‰²é€šé“ï¼› å®½åº¦ï¼ˆWidthï¼‰ï¼š28ï¼Œå›¾åƒçš„å®½åº¦ä¸º28åƒç´ ï¼› é«˜åº¦ï¼ˆHeightï¼‰ï¼š28ï¼Œå›¾åƒçš„é«˜åº¦ä¸º28åƒç´ ã€‚ åœ¨å®é™…åº”ç”¨ä¸­ï¼Œå½©è‰²å›¾åƒé€šå¸¸åŒ…å«çº¢ï¼ˆRï¼‰ã€ç»¿ï¼ˆGï¼‰ã€è“ï¼ˆBï¼‰ä¸‰ä¸ªé€šé“ï¼ˆchannelï¼‰ã€‚ 1.2 æ•°å­—å›¾åƒçš„æœ¬è´¨æ•°å­—å›¾åƒï¼ˆdigital imageï¼‰æœ¬è´¨ä¸Šæ˜¯ç”±åƒç´ ï¼ˆPixelï¼‰ç»„æˆçš„äºŒç»´çŸ©é˜µï¼Œæ¯ä¸ªåƒç´ è®°å½•äº†å¯¹åº”ä½ç½®çš„å…‰å¼ºæˆ–é¢œè‰²ä¿¡æ¯ã€‚ åœ¨æ•°å­—æˆåƒç³»ç»Ÿï¼ˆdigital imaging systemï¼‰ä¸­ï¼Œå¸¸ç”¨å…‰æ•ç”µé˜»ï¼ˆPhotoresistorï¼‰æˆ–å…‰ç”µäºŒæç®¡ï¼ˆPhotodiodeï¼‰ä½œä¸ºæ„Ÿå…‰å…ƒä»¶ã€‚å…‰æ•ç”µé˜»çš„ç”µé˜»å€¼ä¼šéšç€å…‰ç…§å¼ºåº¦çš„å˜åŒ–è€Œå˜åŒ–ã€‚ é€šè¿‡åœ¨ç”µè·¯ä¸­æµ‹é‡å…‰æ•ç”µé˜»ä¸¤ç«¯çš„ç”µå‹å’Œç”µæµï¼Œå¯ä»¥è®¡ç®—å‡ºå…¶ç”µé˜»å€¼ï¼Œè¿›è€Œæ¨ç®—å‡ºè¯¥ä½ç½®çš„å…‰å¼ºã€‚ æˆåƒæ—¶ï¼Œé€šå¸¸ä¼šä½¿ç”¨é€é•œç³»ç»Ÿå°†å¤–éƒ¨å…‰çº¿èšç„¦åˆ°æ„Ÿå…‰å…ƒä»¶é˜µåˆ—ä¸Šã€‚æ¯ä¸ªå…‰æ•ç”µé˜»å¯¹åº”ä¸€ä¸ªå…‰é”¥ï¼Œæ¥æ”¶å™¨å°ºå¯¸è¶Šå°ï¼Œå…‰é”¥è§’åº¦è¶Šå°ï¼Œèƒ½å¤Ÿé‡‡é›†çš„ç©ºé—´åˆ†è¾¨ç‡è¶Šé«˜ã€‚ å¤šä¸ªå…‰æ•ç”µé˜»æŒ‰ç…§è§„åˆ™æ’å¸ƒï¼Œå½¢æˆæ„Ÿå…‰é˜µåˆ—ï¼Œæ¯ä¸ªå…‰æ•ç”µé˜»å³ä¸ºä¸€ä¸ªåƒç´ ã€‚æ•´ä¸ªé˜µåˆ—å³å¯é‡‡é›†ä¸€å¹…å®Œæ•´çš„å›¾åƒã€‚ å½©è‰²å›¾åƒé€šå¸¸åœ¨æ¯ä¸ªåƒç´ ä½ç½®ä¸Šè®¾ç½®å¤šä¸ªä¸åŒé¢œè‰²æ»¤å…‰ç‰‡ï¼ˆå¦‚çº¢ã€ç»¿ã€è“ï¼‰ï¼Œåˆ†åˆ«é‡‡é›†ä¸åŒæ³¢æ®µçš„å…‰å¼ºï¼Œå®ç°å½©è‰²æˆåƒã€‚ åœ¨å®é™…çš„å½©è‰²æ•°å­—æˆåƒè®¾å¤‡ä¸­ï¼Œæœ€å¸¸è§çš„æ»¤è‰²ç‰‡æ’åˆ—æ–¹å¼æ˜¯æ‹œè€³é˜µåˆ—ï¼ˆBayer Patternï¼‰ï¼Œå…¶ä¸­æœ€å¸¸è§çš„æ˜¯RGGBæ’åˆ—ã€‚RGGBè¡¨ç¤ºæ¯2Ã—2çš„åƒç´ å—ä¸­æœ‰2ä¸ªç»¿è‰²ã€1ä¸ªçº¢è‰²å’Œ1ä¸ªè“è‰²æ»¤å…‰ç‰‡ï¼Œæ’åˆ—å¦‚ä¸‹ï¼š çº¢ï¼ˆRï¼‰ ç»¿ï¼ˆGï¼‰ ç»¿ï¼ˆGï¼‰ è“ï¼ˆBï¼‰ è¿™ç§è®¾è®¡æ˜¯å› ä¸ºäººçœ¼å¯¹ç»¿è‰²æ›´æ•æ„Ÿï¼Œå› æ­¤ç»¿è‰²åƒç´ æ•°é‡æ›´å¤šã€‚é€šè¿‡æ‹œè€³é˜µåˆ—é‡‡é›†åˆ°çš„åŸå§‹æ•°æ®ï¼Œç»è¿‡æ’å€¼ç®—æ³•ï¼ˆå»é©¬èµ›å…‹ï¼ŒDemosaicingï¼‰åï¼Œå¯ä»¥è¿˜åŸå‡ºå…¨åˆ†è¾¨ç‡çš„å½©è‰²å›¾åƒã€‚ å› æ­¤ï¼Œæ•°å­—å›¾åƒçš„æœ¬è´¨æ˜¯å¯¹ç©ºé—´ä¸­å…‰å¼ºåˆ†å¸ƒçš„ç¦»æ•£é‡‡æ ·å’Œæ•°å­—åŒ–è¡¨è¾¾ã€‚åˆ†è¾¨ç‡è¶Šé«˜ï¼Œèƒ½å¤Ÿè¿˜åŸçš„ç»†èŠ‚è¶Šä¸°å¯Œã€‚ 1.3 æ …æ ¼å›¾åƒä¸çŸ¢é‡å›¾åƒ æ …æ ¼å›¾åƒï¼ˆRaster Imageï¼‰ï¼šç”±åƒç´ ï¼ˆPixelï¼‰ç»„æˆçš„äºŒç»´çŸ©é˜µï¼Œæ¯ä¸ªåƒç´ æœ‰å›ºå®šçš„é¢œè‰²æˆ–ç°åº¦å€¼ã€‚å¸¸è§æ ¼å¼æœ‰JPEGã€PNGã€BMPç­‰ã€‚ä¼˜ç‚¹æ˜¯èƒ½å¤Ÿè¡¨ç°ä¸°å¯Œçš„ç»†èŠ‚å’Œå¤æ‚çš„è‰²å½©å˜åŒ–ï¼Œé€‚åˆç…§ç‰‡ã€æ‰«æå›¾åƒç­‰ã€‚ç¼ºç‚¹æ˜¯æ”¾å¤§åä¼šå‡ºç°é”¯é½¿ï¼ˆå¤±çœŸï¼‰ï¼Œæ–‡ä»¶ä½“ç§¯è¾ƒå¤§ã€‚ çŸ¢é‡å›¾åƒï¼ˆVector Imageï¼‰ï¼šç”±ç‚¹ã€çº¿ã€æ›²çº¿å’Œå¤šè¾¹å½¢ç­‰å‡ ä½•å›¾å½¢é€šè¿‡æ•°å­¦å…¬å¼æè¿°ã€‚å¸¸è§æ ¼å¼æœ‰SVGã€EPSã€PDFç­‰ã€‚ä¼˜ç‚¹æ˜¯æ— è®ºæ”¾å¤§å¤šå°‘å€éƒ½ä¸ä¼šå¤±çœŸï¼Œæ–‡ä»¶ä½“ç§¯é€šå¸¸è¾ƒå°ï¼Œé€‚åˆå›¾æ ‡ã€æ ‡å¿—ã€æ’ç”»ç­‰ã€‚ç¼ºç‚¹æ˜¯ä¸é€‚åˆè¡¨ç°å¤æ‚çš„è‰²å½©æ¸å˜å’Œç»†èŠ‚ä¸°å¯Œçš„ç…§ç‰‡ã€‚ åº”ç”¨åœºæ™¯ï¼š æ …æ ¼å›¾åƒå¸¸ç”¨äºæ•°ç æ‘„å½±ã€åŒ»å­¦å½±åƒã€é¥æ„Ÿç­‰éœ€è¦è¡¨ç°çœŸå®ä¸–ç•Œç»†èŠ‚çš„åœºåˆã€‚ çŸ¢é‡å›¾åƒå¸¸ç”¨äºå¹³é¢è®¾è®¡ã€æ’ç‰ˆã€CADåˆ¶å›¾ç­‰éœ€è¦é«˜ç²¾åº¦ç¼©æ”¾å’Œæ¸…æ™°è¾¹ç•Œçš„åœºåˆã€‚ 2. å·ç§¯æ“ä½œä¸ç‰¹å¾æå–2.1 å·ç§¯æ“ä½œçš„åŸºæœ¬åŸç†åœ¨è¿›è¡Œå·ç§¯æ“ä½œæ—¶ï¼Œé€šå¸¸ä¼šåœ¨å›¾åƒä¸Šé€‰å–ä¸€ä¸ªå°å—ï¼ˆpatchï¼‰ï¼Œå…¶å½¢çŠ¶ä¸º 3Ã—Hâ€²Ã—Wâ€²3 \\times H' \\times W'3Ã—Hâ€²Ã—Wâ€²ï¼Œå…¶ä¸­3è¡¨ç¤ºè¾“å…¥çš„é€šé“æ•°ï¼ˆå¦‚RGBä¸‰é€šé“ï¼‰ï¼ŒHâ€²H'Hâ€² å’Œ Wâ€²W'Wâ€² åˆ†åˆ«ä¸ºè¯¥å—çš„é«˜åº¦å’Œå®½åº¦ã€‚è¿™ä¸ªå°å—ä¼šä½œä¸ºå·ç§¯æ ¸çš„æ„Ÿå—é‡ï¼Œåœ¨æ•´å¼ å›¾åƒä¸Šä»¥æ»‘åŠ¨çª—å£çš„æ–¹å¼ç§»åŠ¨ï¼Œéå†æ‰€æœ‰ä½ç½®ã€‚æ¯æ¬¡æ»‘åŠ¨æ—¶ï¼Œå¯¹å½“å‰åŒºåŸŸè¿›è¡Œå·ç§¯è®¡ç®—ï¼Œå¾—åˆ°ä¸€ä¸ªè¾“å‡ºå€¼ã€‚æ‰€æœ‰ä½ç½®çš„è¾“å‡ºå€¼æ‹¼æ¥åœ¨ä¸€èµ·ï¼Œå½¢æˆæ–°çš„ç‰¹å¾å›¾ï¼ˆfeature mapï¼‰ã€‚å·ç§¯æ“ä½œå®Œæˆåï¼Œè¾“å‡ºçš„é€šé“æ•°ã€å®½åº¦å’Œé«˜åº¦é€šå¸¸ä¼šå‘ç”Ÿå˜åŒ–ã€‚æ¯ä¸ªè¾“å‡ºé€šé“ï¼ˆoutput channelï¼‰éƒ½ç»¼åˆäº†è¾“å…¥patchä¸­çš„å…¨éƒ¨ä¿¡æ¯ï¼Œä»£è¡¨äº†ä¸åŒçš„ç‰¹å¾å“åº”ã€‚ 2.2 å·ç§¯å±‚çš„ç»“æ„ä¸æµç¨‹ å›¾åƒé¦–å…ˆç»è¿‡å·ç§¯å±‚ï¼ˆconvolutional layerï¼‰ï¼Œå¦‚ 5Ã—55 \\times 55Ã—5 å·ç§¯æ ¸ï¼Œå¯ä»¥å¾—åˆ°4ä¸ªé€šé“ã€æ¯ä¸ªé€šé“ 24Ã—2424 \\times 2424Ã—24 çš„ç‰¹å¾å›¾ï¼ˆfeature mapï¼Œè®°ä½œ C1C_1C1â€‹ï¼‰ã€‚å·ç§¯å±‚çš„ä½œç”¨æ˜¯æå–å›¾åƒçš„ç©ºé—´ç‰¹å¾ã€‚å·ç§¯æ“ä½œåï¼Œè¾“å‡ºå¼ é‡ä¾ç„¶ä¿æŒä¸‰ç»´ç»“æ„ï¼ˆé€šé“æ•° Ã— å®½åº¦ Ã— é«˜åº¦ï¼‰ï¼Œä½†é€šé“æ•°ã€å®½åº¦å’Œé«˜åº¦å¯èƒ½å‘ç”Ÿå˜åŒ–ã€‚ ä¸å…¨è¿æ¥å±‚ï¼ˆfully connected layerï¼‰ä¸åŒï¼Œå…¨è¿æ¥å±‚ä¼šå°†å›¾åƒå±•å¹³æˆä¸€ç»´å‘é‡ï¼Œä¸§å¤±åŸæœ‰çš„ç©ºé—´ç»“æ„ä¿¡æ¯ã€‚ å·ç§¯å±‚è¾“å‡ºçš„ç‰¹å¾å›¾é€šå¸¸ä¼šç»è¿‡ä¸‹é‡‡æ ·ï¼ˆsubsampling/poolingï¼‰ï¼Œå¦‚ 2Ã—22 \\times 22Ã—2 æ± åŒ–ï¼Œå¾—åˆ°æ–°çš„ç‰¹å¾å›¾ï¼ˆS1S_1S1â€‹ï¼‰ï¼Œä¾‹å¦‚4ä¸ªé€šé“ã€æ¯ä¸ªé€šé“ 12Ã—1212 \\times 1212Ã—12ã€‚ä¸‹é‡‡æ ·æ“ä½œä¼šå‡å°å®½åº¦å’Œé«˜åº¦ï¼Œé€šé“æ•°ä¿æŒä¸å˜ï¼Œä¸»è¦ç›®çš„æ˜¯å‡å°‘æ•°æ®é‡ï¼Œé™ä½è®¡ç®—å¤æ‚åº¦ã€‚ å¯ä»¥ç»§ç»­å †å å·ç§¯å±‚å’Œä¸‹é‡‡æ ·å±‚ã€‚ä¾‹å¦‚ï¼Œå†ç»è¿‡ä¸€ä¸ª 5Ã—55 \\times 55Ã—5 å·ç§¯ï¼Œå¾—åˆ° C2C_2C2â€‹ï¼ˆ8ä¸ªé€šé“ï¼Œ8Ã—88 \\times 88Ã—8ï¼‰ï¼Œå†ä¸‹é‡‡æ ·ä¸€æ¬¡ï¼Œå¾—åˆ° S2S_2S2â€‹ï¼ˆ8ä¸ªé€šé“ï¼Œ4Ã—44 \\times 44Ã—4ï¼‰ã€‚ æœ€åï¼Œå°†ä¸‰é˜¶å¼ é‡ï¼ˆå¦‚ 8Ã—4Ã—48 \\times 4 \\times 48Ã—4Ã—4ï¼‰å±•å¹³æˆä¸€ç»´å‘é‡ï¼ˆé€šè¿‡ view æ“ä½œï¼‰ï¼Œå†é€šè¿‡å…¨è¿æ¥å±‚æ˜ å°„åˆ°åç»´è¾“å‡ºï¼Œå®Œæˆåˆ†ç±»ä»»åŠ¡ã€‚å¸¸ç”¨äº¤å‰ç†µæŸå¤±ï¼ˆcross-entropy lossï¼‰å’Œ softmax è¿›è¡Œæ¦‚ç‡åˆ†å¸ƒè®¡ç®—ã€‚ æ€»ç»“ï¼šæ„å»ºç¥ç»ç½‘ç»œæ—¶ï¼Œéœ€è¦æ˜ç¡®è¾“å…¥å’Œè¾“å‡ºå¼ é‡çš„ç»´åº¦ï¼Œå¹¶é€šè¿‡ä¸åŒçš„å±‚ç»“æ„å°†å…¶æ˜ å°„åˆ°ç›®æ ‡ç©ºé—´ï¼Œå®ç°ç‰¹å¾æå–ä¸åˆ†ç±»ï¼ˆFeature Extraction + Classificationï¼‰ã€‚ 3. å·ç§¯æ“ä½œçš„æ•°å­¦ä¸ä»£ç ç¤ºä¾‹3.1 å•é€šé“å·ç§¯è®¡ç®—è¿‡ç¨‹ä»¥ 5Ã—55 \\times 55Ã—5 çš„è¾“å…¥çŸ©é˜µå’Œ 3Ã—33 \\times 33Ã—3 çš„å·ç§¯æ ¸ä¸ºä¾‹ï¼Œæ¼”ç¤ºå·ç§¯æ“ä½œçš„è®¡ç®—è¿‡ç¨‹ï¼š è¾“å…¥ï¼ˆInputï¼‰ï¼š 3 4 6 5 7 2 4 6 8 2 1 6 7 8 4 9 7 4 6 2 3 7 5 4 1 å·ç§¯æ ¸ï¼ˆKernelï¼‰ï¼š 1 2 3 4 5 6 7 8 9 è¾“å‡ºï¼ˆOutputï¼‰ï¼š 211 295 262 259 282 214 251 253 169 è¯¦ç»†è®¡ç®—è¿‡ç¨‹ï¼š å·¦ä¸Šè§’è¾“å‡ºï¼ˆç¬¬1è¡Œç¬¬1åˆ—ï¼‰ï¼š 3Ã—1+4Ã—2+6Ã—3+2Ã—4+4Ã—5+6Ã—6+1Ã—7+6Ã—8+7Ã—9=2113\\times1 + 4\\times2 + 6\\times3 + 2\\times4 + 4\\times5 + 6\\times6 + 1\\times7 + 6\\times8 + 7\\times9 = 2113Ã—1+4Ã—2+6Ã—3+2Ã—4+4Ã—5+6Ã—6+1Ã—7+6Ã—8+7Ã—9=211 ç¬¬1è¡Œç¬¬2åˆ—ï¼š 4Ã—1+6Ã—2+5Ã—3+4Ã—4+6Ã—5+8Ã—6+6Ã—7+7Ã—8+8Ã—9=2954\\times1 + 6\\times2 + 5\\times3 + 4\\times4 + 6\\times5 + 8\\times6 + 6\\times7 + 7\\times8 + 8\\times9 = 2954Ã—1+6Ã—2+5Ã—3+4Ã—4+6Ã—5+8Ã—6+6Ã—7+7Ã—8+8Ã—9=295 ç¬¬1è¡Œç¬¬3åˆ—ï¼š 6Ã—1+5Ã—2+7Ã—3+6Ã—4+8Ã—5+2Ã—6+7Ã—7+8Ã—8+4Ã—9=2626\\times1 + 5\\times2 + 7\\times3 + 6\\times4 + 8\\times5 + 2\\times6 + 7\\times7 + 8\\times8 + 4\\times9 = 2626Ã—1+5Ã—2+7Ã—3+6Ã—4+8Ã—5+2Ã—6+7Ã—7+8Ã—8+4Ã—9=262 ç¬¬2è¡Œç¬¬1åˆ—ï¼š 2Ã—1+4Ã—2+6Ã—3+1Ã—4+6Ã—5+7Ã—6+9Ã—7+7Ã—8+4Ã—9=2592\\times1 + 4\\times2 + 6\\times3 + 1\\times4 + 6\\times5 + 7\\times6 + 9\\times7 + 7\\times8 + 4\\times9 = 2592Ã—1+4Ã—2+6Ã—3+1Ã—4+6Ã—5+7Ã—6+9Ã—7+7Ã—8+4Ã—9=259 ç¬¬2è¡Œç¬¬2åˆ—ï¼š 4Ã—1+6Ã—2+8Ã—3+6Ã—4+7Ã—5+8Ã—6+7Ã—7+4Ã—8+6Ã—9=2824\\times1 + 6\\times2 + 8\\times3 + 6\\times4 + 7\\times5 + 8\\times6 + 7\\times7 + 4\\times8 + 6\\times9 = 2824Ã—1+6Ã—2+8Ã—3+6Ã—4+7Ã—5+8Ã—6+7Ã—7+4Ã—8+6Ã—9=282 ç¬¬2è¡Œç¬¬3åˆ—ï¼š 6Ã—1+8Ã—2+2Ã—3+7Ã—4+8Ã—5+4Ã—6+4Ã—7+6Ã—8+2Ã—9=2146\\times1 + 8\\times2 + 2\\times3 + 7\\times4 + 8\\times5 + 4\\times6 + 4\\times7 + 6\\times8 + 2\\times9 = 2146Ã—1+8Ã—2+2Ã—3+7Ã—4+8Ã—5+4Ã—6+4Ã—7+6Ã—8+2Ã—9=214 ç¬¬3è¡Œç¬¬1åˆ—ï¼š 1Ã—1+6Ã—2+7Ã—3+9Ã—4+7Ã—5+4Ã—6+3Ã—7+7Ã—8+5Ã—9=2511\\times1 + 6\\times2 + 7\\times3 + 9\\times4 + 7\\times5 + 4\\times6 + 3\\times7 + 7\\times8 + 5\\times9 = 2511Ã—1+6Ã—2+7Ã—3+9Ã—4+7Ã—5+4Ã—6+3Ã—7+7Ã—8+5Ã—9=251 ç¬¬3è¡Œç¬¬2åˆ—ï¼š 6Ã—1+7Ã—2+8Ã—3+7Ã—4+4Ã—5+6Ã—6+7Ã—7+5Ã—8+4Ã—9=2536\\times1 + 7\\times2 + 8\\times3 + 7\\times4 + 4\\times5 + 6\\times6 + 7\\times7 + 5\\times8 + 4\\times9 = 2536Ã—1+7Ã—2+8Ã—3+7Ã—4+4Ã—5+6Ã—6+7Ã—7+5Ã—8+4Ã—9=253 ç¬¬3è¡Œç¬¬3åˆ—ï¼š 7Ã—1+8Ã—2+4Ã—3+4Ã—4+6Ã—5+2Ã—6+5Ã—7+4Ã—8+1Ã—9=1697\\times1 + 8\\times2 + 4\\times3 + 4\\times4 + 6\\times5 + 2\\times6 + 5\\times7 + 4\\times8 + 1\\times9 = 1697Ã—1+8Ã—2+4Ã—3+4Ã—4+6Ã—5+2Ã—6+5Ã—7+4Ã—8+1Ã—9=169 æ³¨ï¼šæ¯ä¸ªè¾“å‡ºå€¼å¯¹åº”å·ç§¯æ ¸åœ¨è¾“å…¥çŸ©é˜µä¸Šæ»‘åŠ¨åˆ°ä¸åŒä½ç½®æ—¶ï¼Œpatchä¸kernelå¯¹åº”å…ƒç´ ç›¸ä¹˜åæ±‚å’Œçš„ç»“æœã€‚ 3.2 å¤šé€šé“å·ç§¯çš„ç»“æ„ä¸å‚æ•°åœ¨å·ç§¯ç¥ç»ç½‘ç»œä¸­ï¼Œå¤šé€šé“å·ç§¯çš„æœ¬è´¨æ˜¯ï¼šæ¯ä¸ªè¾“å‡ºé€šé“éƒ½é€šè¿‡å¯¹æ‰€æœ‰è¾“å…¥é€šé“åˆ†åˆ«è¿›è¡Œå·ç§¯ã€å†å°†ç»“æœæŒ‰å…ƒç´ ç›¸åŠ å¾—åˆ°ã€‚ æ›´ä¸ºä¸¥è°¨åœ°è¯´ï¼Œå‡è®¾è¾“å…¥ç‰¹å¾å›¾çš„é€šé“æ•°ä¸º CinC_{in}Cinâ€‹ï¼Œè¾“å‡ºç‰¹å¾å›¾çš„é€šé“æ•°ä¸º CoutC_{out}Coutâ€‹ï¼Œå·ç§¯æ ¸çš„ç©ºé—´å°ºå¯¸ä¸º KhÃ—KwK_h \\times K_wKhâ€‹Ã—Kwâ€‹ã€‚é‚£ä¹ˆï¼Œå·ç§¯æ ¸çš„æƒé‡å¼ é‡å½¢çŠ¶ä¸ºï¼š (out_channels, in_channels, kernel_size_h, kernel_size_w) å…¶ä¸­ï¼Œkernel_size_h å’Œ kernel_size_w åˆ†åˆ«è¡¨ç¤ºå·ç§¯æ ¸çš„é«˜åº¦å’Œå®½åº¦ã€‚ å…·ä½“è®¡ç®—æµç¨‹å¦‚ä¸‹ï¼š æ¯ä¸ªè¾“å‡ºé€šé“çš„ç”Ÿæˆ å¯¹äºæ¯ä¸€ä¸ªè¾“å‡ºé€šé“ o (o=1,2,â€¦,C_out)ï¼Œéƒ½å¯¹åº”æœ‰ C_in ä¸ªäºŒç»´å·ç§¯æ ¸ï¼ˆæ¯ä¸ªè¾“å…¥é€šé“ä¸€ä¸ªï¼‰ã€‚ å¯¹äºæ¯ä¸ªè¾“å…¥é€šé“ i (i=1,2,â€¦,C_in)ï¼Œç”¨è¯¥é€šé“çš„è¾“å…¥ç‰¹å¾å›¾ä¸å¯¹åº”çš„å·ç§¯æ ¸è¿›è¡ŒäºŒç»´å·ç§¯ï¼Œå¾—åˆ°ä¸€ä¸ªä¸­é—´ç‰¹å¾å›¾ã€‚ å°†æ‰€æœ‰ C_in ä¸ªä¸­é—´ç‰¹å¾å›¾æŒ‰å…ƒç´ ç›¸åŠ ï¼ˆé€å…ƒç´ æ±‚å’Œï¼‰ï¼Œå¾—åˆ°è¯¥è¾“å‡ºé€šé“çš„æœ€ç»ˆç‰¹å¾å›¾ã€‚ å·ç§¯æ ¸æƒé‡çš„ç»„ç»‡ æ•´ä¸ªå·ç§¯å±‚çš„æƒé‡æ˜¯ä¸€ä¸ªå››ç»´å¼ é‡ï¼Œå½¢çŠ¶ä¸º (out_channels, in_channels, kernel_size_h, kernel_size_w)ã€‚ å…¶ä¸­ï¼Œç¬¬ o ä¸ªè¾“å‡ºé€šé“çš„å·ç§¯æ ¸æƒé‡ä¸º W[o, :, :, :]ï¼ŒåŒ…å«äº†å¯¹æ‰€æœ‰è¾“å…¥é€šé“çš„å·ç§¯æ ¸ã€‚ è¾“å‡ºå¼ é‡çš„å½¢çŠ¶ å‡è®¾è¾“å…¥å¼ é‡å½¢çŠ¶ä¸º (N, C_in, H_in, W_in)ï¼Œå…¶ä¸­ N æ˜¯æ‰¹é‡å¤§å°ã€‚ è¾“å‡ºå¼ é‡çš„å½¢çŠ¶ä¸º (N, C_out, H_out, W_out)ï¼Œå…¶ä¸­ H_out å’Œ W_out ç”±è¾“å…¥å°ºå¯¸ã€å·ç§¯æ ¸å°ºå¯¸ã€æ­¥å¹…ã€å¡«å……ç­‰å‚æ•°å…±åŒå†³å®šã€‚ ä¸¾ä¾‹è¯´æ˜ ä»¥å¸¸è§çš„ RGB å›¾åƒä¸ºä¾‹ï¼ŒC_in=3ã€‚è‹¥è®¾ç½® C_out=16ï¼Œåˆ™è¯¥å·ç§¯å±‚å…±æœ‰ 16Ã—3=48 ä¸ªäºŒç»´å·ç§¯æ ¸ï¼Œæ¯ä¸ªè¾“å‡ºé€šé“éƒ½èåˆäº†æ‰€æœ‰è¾“å…¥é€šé“çš„ä¿¡æ¯ã€‚ æ€»ç»“ï¼š æ¯ä¸ªè¾“å‡ºé€šé“éƒ½èšåˆäº†æ‰€æœ‰è¾“å…¥é€šé“çš„å·ç§¯ç»“æœã€‚ å·ç§¯æ ¸çš„å››ç»´ç»“æ„ç¡®ä¿äº†è¾“å…¥é€šé“å’Œè¾“å‡ºé€šé“ä¹‹é—´çš„å…¨è¿æ¥ã€‚ è¿™ç§è®¾è®¡ä½¿å¾—ç½‘ç»œèƒ½å¤Ÿå­¦ä¹ åˆ°è·¨é€šé“çš„å¤æ‚ç‰¹å¾ç»„åˆã€‚ å› æ­¤ï¼ŒPyTorch ç­‰æ·±åº¦å­¦ä¹ æ¡†æ¶ä¸­ï¼ŒConv2d å±‚çš„æƒé‡å‚æ•°å½¢çŠ¶ä¸º (out_channels, in_channels, kernel_size_h, kernel_size_w)ï¼Œä¸¥æ ¼å¯¹åº”ä¸Šè¿°æ•°å­¦æè¿°ã€‚ 3.3 ä»£ç ç¤ºä¾‹ï¼šå¤šé€šé“å·ç§¯ç”±æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥å†™å‡ºå·ç§¯æ“ä½œçš„ç¤ºä¾‹ä»£ç ï¼š import torch in_channels, out_channels = 5, 10 width, height = 100, 100 kernel_size = 3 batch_size = 1 input = torch.randn(batch_size, in_channels, width, height) conv_layer = torch.nn.Conv2d(in_channels, out_channels, kernel_size = kernel_size) output = conv_layer(input) print(input.shape) print(output.shape) print(conv_layer.weight.shape) ä¸‹é¢å¯¹ä¸Šè¿°ä»£ç ä¸­çš„å„ä¸ªå‚æ•°å’Œæ“ä½œè¿›è¡Œæœ‰æ¡ç†çš„è¯´æ˜ï¼š è¾“å…¥è¾“å‡ºé€šé“æ•° in_channelsï¼šè¡¨ç¤ºè¾“å…¥å¼ é‡çš„é€šé“æ•°ã€‚ä¾‹å¦‚ï¼Œå¯¹äºRGBå½©è‰²å›¾åƒï¼Œin_channels=3ï¼›å¯¹äºç°åº¦å›¾åƒï¼Œin_channels=1ã€‚æœ¬ä¾‹ä¸­è®¾ä¸º5ï¼Œè¡¨ç¤ºè¾“å…¥æœ‰5ä¸ªé€šé“ã€‚ out_channelsï¼šè¡¨ç¤ºå·ç§¯æ“ä½œåè¾“å‡ºå¼ é‡çš„é€šé“æ•°ã€‚è¿™ä¸ªå€¼ç”±æˆ‘ä»¬è‡ªè¡Œè®¾å®šï¼Œé€šå¸¸è¶Šå¤§ï¼Œç½‘ç»œèƒ½å¤Ÿå­¦ä¹ åˆ°çš„ç‰¹å¾è¶Šä¸°å¯Œã€‚æœ¬ä¾‹ä¸­è®¾ä¸º10ã€‚ å›¾åƒå°ºå¯¸ width å’Œ heightï¼šåˆ†åˆ«è¡¨ç¤ºè¾“å…¥å›¾åƒçš„å®½åº¦å’Œé«˜åº¦ã€‚æœ¬ä¾‹ä¸­å‡ä¸º100ã€‚ å·ç§¯æ ¸å¤§å° kernel_sizeï¼šæŒ‡å®šå·ç§¯æ ¸çš„ç©ºé—´å°ºå¯¸ã€‚å¯ä»¥æ˜¯å•ä¸ªæ•´æ•°ï¼ˆè¡¨ç¤ºæ­£æ–¹å½¢å·ç§¯æ ¸ï¼‰ï¼Œä¹Ÿå¯ä»¥æ˜¯äºŒå…ƒç»„ï¼ˆå¦‚(3, 5)ï¼Œè¡¨ç¤ºéæ­£æ–¹å½¢å·ç§¯æ ¸ï¼‰ã€‚æœ¬ä¾‹ä¸­ä¸º3ï¼Œè¡¨ç¤º 3Ã—33 \\times 33Ã—3 çš„å·ç§¯æ ¸ã€‚ è¾“å…¥å¼ é‡çš„ç”Ÿæˆ input = torch.randn(batch_size, in_channels, width, height)ï¼šç”Ÿæˆä¸€ä¸ªå½¢çŠ¶ä¸º (batch_size, in_channels, width, height) çš„å››ç»´å¼ é‡ï¼Œå…ƒç´ æœä»æ ‡å‡†æ­£æ€åˆ†å¸ƒã€‚è¿™é‡Œ batch_size=1ï¼Œè¡¨ç¤ºä¸€æ¬¡åªè¾“å…¥ä¸€å¼ å¤šé€šé“å›¾åƒã€‚ å·ç§¯å±‚çš„å®šä¹‰ conv_layer = torch.nn.Conv2d(in_channels, out_channels, kernel_size=kernel_size)ï¼šåˆ›å»ºä¸€ä¸ªäºŒç»´å·ç§¯å±‚ã€‚éœ€è¦æŒ‡å®šè¾“å…¥é€šé“æ•°ã€è¾“å‡ºé€šé“æ•°å’Œå·ç§¯æ ¸å¤§å°è¿™ä¸‰ä¸ªæ ¸å¿ƒå‚æ•°ã€‚ æ³¨æ„ï¼šå·ç§¯æ ¸çš„å½¢çŠ¶ä¸ä¸€å®šè¦æ˜¯æ­£æ–¹å½¢ï¼ˆå³width=heightï¼‰ï¼Œä½†å®é™…åº”ç”¨ä¸­å¸¸ç”¨æ­£æ–¹å½¢å·ç§¯æ ¸ï¼ˆå¦‚ 3Ã—33 \\times 33Ã—3ã€5Ã—55 \\times 55Ã—5 ç­‰ï¼‰ï¼Œå› ä¸ºå…¶åœ¨ç©ºé—´ä¸Šå…·æœ‰å¯¹ç§°æ€§ï¼Œä¾¿äºç‰¹å¾æå–ã€‚ é€šè¿‡ä¸Šè¿°å‚æ•°çš„è®¾å®šï¼Œå¯ä»¥çµæ´»åœ°æ„å»ºé€‚ç”¨äºä¸åŒè¾“å…¥æ•°æ®å’Œä»»åŠ¡éœ€æ±‚çš„å·ç§¯å±‚ç»“æ„ã€‚ è¾“å‡ºç»“æœå¦‚ä¸‹ï¼š torch.Size([1, 5, 100, 100]) torch.Size([1, 10, 98, 98]) torch.Size([10, 5, 3, 3]) 4. å·ç§¯æ“ä½œçš„å‚æ•°è¯¦è§£4.1 Paddingï¼ˆå¡«å……ï¼‰Paddingï¼ˆå¡«å……ï¼‰ç”¨äºåœ¨è¾“å…¥ç‰¹å¾å›¾çš„è¾¹ç¼˜è¡¥é›¶ï¼Œä»¥æ§åˆ¶è¾“å‡ºç‰¹å¾å›¾çš„ç©ºé—´å°ºå¯¸ã€‚ å…¬å¼ï¼š padding = (kernel_size - 1) / 2 å…¶ä¸­ kernel_size æ˜¯å·ç§¯æ ¸çš„å°ºå¯¸ï¼ˆå¦‚ 3ã€5ã€7 ç­‰ï¼‰ã€‚å¦‚æœå·ç§¯æ ¸å°ºå¯¸ä¸ºå¥‡æ•°ï¼Œè¿™ä¸ªå…¬å¼å¯ä»¥ä¿è¯è¾“å‡ºå°ºå¯¸ä¸è¾“å…¥å°ºå¯¸ä¸€è‡´ã€‚ ä»£ç ç¤ºä¾‹ï¼šPaddingimport torch input = [3, 4, 6, 5, 7, 2, 4, 6, 8, 2, 1, 6, 7, 8, 4, 9, 7, 4, 6, 2, 3, 7, 5, 4, 1] input = torch.Tensor(input).view(1, 1, 5, 5) conv_layer = torch.nn.Conv2d(1, 1, kernel_size = 3, padding = 1) kernel = torch.Tensor([1, 2, 3, 4, 5, 6, 7, 8, 9]).view(1, 1, 3, 3) conv_layer.weight.data = kernel.data output = conv_layer(input) print(output) ä¸Šè¿°ä»£ç æ¼”ç¤ºäº†å¦‚ä½•åœ¨ PyTorch ä¸­æ‰‹åŠ¨è®¾ç½®è¾“å…¥ã€å·ç§¯æ ¸ï¼Œå¹¶ä½¿ç”¨ padding è¿›è¡Œå·ç§¯æ“ä½œã€‚ é¦–å…ˆï¼Œå®šä¹‰äº†ä¸€ä¸ª 5Ã—55 \\times 55Ã—5 çš„è¾“å…¥çŸ©é˜µï¼Œå¹¶ç”¨ torch.Tensor(...).view(1, 1, 5, 5) å˜æˆå››ç»´å¼ é‡ï¼Œç¬¦åˆå·ç§¯å±‚çš„è¾“å…¥æ ¼å¼ï¼ˆbatch size, channel, height, widthï¼‰ã€‚ åˆ›å»ºäº†ä¸€ä¸ª 3Ã—33 \\times 33Ã—3 çš„å·ç§¯æ ¸ï¼Œå¹¶æ‰‹åŠ¨èµ‹å€¼ç»™å·ç§¯å±‚çš„æƒé‡ã€‚ padding=1 è¡¨ç¤ºåœ¨è¾“å…¥çš„æ¯ä¸€è¾¹éƒ½è¡¥ä¸Šä¸€åœˆ0ï¼Œä½¿å¾—è¾“å‡ºçš„ç©ºé—´å°ºå¯¸ä¸è¾“å…¥ä¸€è‡´ã€‚ æœ€åï¼Œå°†è¾“å…¥é€å…¥å·ç§¯å±‚ï¼Œè¾“å‡ºç»“æœçš„ç©ºé—´å°ºå¯¸ä»ä¸º 5Ã—55 \\times 55Ã—5ï¼ŒéªŒè¯äº† padding çš„ä½œç”¨ã€‚ é€šè¿‡è¿™ä¸ªä¾‹å­å¯ä»¥ç›´è§‚ç†è§£ padding å¦‚ä½•å½±å“å·ç§¯è¾“å‡ºçš„å°ºå¯¸ã€‚ è¾“å‡ºç»“æœå¦‚ä¸‹ï¼š tensor([[[[ 90.9643, 167.9643, 223.9643, 214.9643, 126.9643], [113.9643, 210.9643, 294.9643, 261.9643, 148.9643], [191.9643, 258.9643, 281.9643, 213.9643, 121.9643], [193.9643, 250.9643, 252.9643, 168.9643, 85.9643], [ 95.9643, 111.9643, 109.9643, 67.9643, 30.9643]]]], grad_fn=&lt;ConvolutionBackward0&gt;) 4.2 Strideï¼ˆæ­¥å¹…ï¼‰Strideï¼ˆæ­¥å¹…ï¼‰ç”¨äºæ§åˆ¶å·ç§¯æ ¸åœ¨è¾“å…¥ç‰¹å¾å›¾ä¸Šæ¯æ¬¡ç§»åŠ¨çš„è·ç¦»ã€‚ stride=2 è¡¨ç¤ºå·ç§¯æ ¸æ¯æ¬¡åœ¨è¾“å…¥ç‰¹å¾å›¾ä¸Šç§»åŠ¨2ä¸ªåƒç´ ï¼ˆè€Œä¸æ˜¯é»˜è®¤çš„1ä¸ªåƒç´ ï¼‰ã€‚ è¿™æ ·ä¼šå¯¼è‡´è¾“å‡ºç‰¹å¾å›¾çš„å®½åº¦å’Œé«˜åº¦éƒ½å˜å°ï¼Œç›¸å½“äºå¯¹è¾“å…¥åšäº†ä¸‹é‡‡æ ·ã€‚ é€šè¿‡è®¾ç½®ä¸åŒçš„strideï¼Œå¯ä»¥çµæ´»æ§åˆ¶è¾“å‡ºç‰¹å¾å›¾çš„ç©ºé—´å°ºå¯¸ã€‚ æœ¬ä¾‹ä¸­ï¼Œè¾“å…¥ä¸º 5Ã—55 \\times 55Ã—5ï¼Œå·ç§¯æ ¸ä¸º 3Ã—33 \\times 33Ã—3ï¼Œstride=2ï¼Œè¾“å‡ºçš„ç©ºé—´å°ºå¯¸ä¼šæ¯”stride=1æ—¶æ›´å°ã€‚ ä»£ç ç¤ºä¾‹ï¼šStrideimport torch input = [3, 4, 6, 5, 7, 2, 4, 6, 8, 2, 1, 6, 7, 8, 4, 9, 7, 4, 6, 2, 3, 7, 5, 4, 1] input = torch.Tensor(input).view(1, 1, 5, 5) conv_layer = torch.nn.Conv2d(1, 1, kernel_size = 3, stride = 2, bias = False) kernel = torch.Tensor([1, 2, 3, 4, 5, 6, 7, 8, 9]).view(1, 1, 3, 3) conv_layer.weight.data = kernel.data output = conv_layer(input) print(output) ä¸Šè¿°ä»£ç æ¼”ç¤ºäº†strideï¼ˆæ­¥å¹…ï¼‰å‚æ•°çš„ä½œç”¨ï¼š stride=2 è¡¨ç¤ºå·ç§¯æ ¸æ¯æ¬¡åœ¨è¾“å…¥ç‰¹å¾å›¾ä¸Šç§»åŠ¨2ä¸ªåƒç´ ã€‚ è¿™æ ·ä¼šå¯¼è‡´è¾“å‡ºç‰¹å¾å›¾çš„å®½åº¦å’Œé«˜åº¦éƒ½å˜å°ï¼Œç›¸å½“äºå¯¹è¾“å…¥åšäº†ä¸‹é‡‡æ ·ã€‚ é€šè¿‡è®¾ç½®ä¸åŒçš„strideï¼Œå¯ä»¥çµæ´»æ§åˆ¶è¾“å‡ºç‰¹å¾å›¾çš„ç©ºé—´å°ºå¯¸ã€‚ æœ¬ä¾‹ä¸­ï¼Œè¾“å…¥ä¸º 5Ã—55 \\times 55Ã—5ï¼Œå·ç§¯æ ¸ä¸º 3Ã—33 \\times 33Ã—3ï¼Œstride=2ï¼Œè¾“å‡ºçš„ç©ºé—´å°ºå¯¸ä¼šæ¯”stride=1æ—¶æ›´å°ã€‚ é€šè¿‡è¿™ä¸ªä¾‹å­å¯ä»¥ç›´è§‚ç†è§£strideå¯¹å·ç§¯è¾“å‡ºå°ºå¯¸çš„å½±å“ã€‚ è¾“å‡ºç»“æœå¦‚ä¸‹ï¼š tensor([[[[211., 262.], [251., 169.]]]], grad_fn=&lt;ConvolutionBackward0&gt;) 5. ä¸‹é‡‡æ ·ï¼ˆPoolingï¼‰æ“ä½œ5.1 MaxPoolingï¼ˆæœ€å¤§æ± åŒ–ï¼‰MaxPoolingï¼ˆæœ€å¤§æ± åŒ–ï¼‰æ˜¯ä¸€ç§å¸¸ç”¨çš„ä¸‹é‡‡æ ·æ–¹æ³•ã€‚å¯¹äº 2Ã—22 \\times 2 2Ã—2 çš„MaxPoolingï¼Œé»˜è®¤stride = 2ã€‚ å…¶åŸç†æ˜¯åœ¨æ¯ä¸ª 2Ã—22 \\times 22Ã—2 åŒºåŸŸå†…å–æœ€å¤§å€¼ï¼Œå‡å°ç‰¹å¾å›¾å°ºå¯¸ï¼Œé€šé“æ•°ä¿æŒä¸å˜ã€‚ Maxpoolingåªèƒ½åœ¨ä¸€ä¸ªé€šé“å†…åšï¼Œé€šé“ä¹‹é—´æ˜¯æ— æ³•åšMaxpoolingçš„ï¼ˆé€šé“æ•°é‡ä¸å˜ï¼Œå›¾åƒå¤§å°å˜åŒ–ï¼‰ã€‚ ä»£ç ç¤ºä¾‹ï¼šMaxPoolingimport torch input = [3, 4, 6, 5, 2, 4, 6, 8, 1, 6, 7, 8, 9, 7, 4, 6] input = torch.Tensor(input).view(1, 1, 4, 4) maxpooling_layer = torch.nn.MaxPool2d(kernel_size = 2) output = maxpooling_layer(input) print(output) è¯¥ä»£ç çš„æ ¸å¿ƒæ˜¯torch.nn.MaxPool2d,å¹¶è®¾ç½®kernel_size = 2,è¿™æ ·åŒæ ·ä¹Ÿé»˜è®¤äº†æ­¥é•¿stride = 2ã€‚ è¾“å‡ºç»“æœå¦‚ä¸‹ï¼š tensor([[[[4., 8.], [9., 8.]]]]) 6. CNNç½‘ç»œç»“æ„æµç¨‹ä¸¾ä¾‹ è¾“å…¥ï¼š(batch, 1, 28, 28) Conv2d Layer 1: filter 5Ã—55 \\times 55Ã—5, CinC_{in}Cinâ€‹:1, CoutC_{out}Coutâ€‹:10 â†’ (batch, 10, 24, 24) Pooling Layer 1: filter 2Ã—22 \\times 22Ã—2 â†’ (batch, 10, 12, 12) Conv2d Layer 2: filter 5Ã—55 \\times 55Ã—5, CinC_{in}Cinâ€‹:10, CoutC_{out}Coutâ€‹:20 â†’ (batch, 20, 8, 8) Pooling Layer 2: filter 2Ã—22 \\times 22Ã—2 â†’ (batch, 20, 4, 4) å±•å¹³æˆå‘é‡ï¼Œç»è¿‡å…¨è¿æ¥å±‚æ˜ å°„ä¸º10ç±»è¾“å‡ºã€‚ æœ€ç»ˆä»£ç å®ç°ï¼š import torch from torchvision import transforms, datasets from torch.utils.data import DataLoader import torch.nn.functional as F import torch.optim as optim batch_size = 64 transform = transforms.Compose([ transforms.ToTensor(), transforms.Normalize((0.1307,), (0.3081,)) ]) train_dataset = datasets.MNIST( root='D:/PythonCode/Pytorch_learning/MNIST', train=True, download=True, transform=transform ) train_loader = DataLoader( train_dataset, batch_size=batch_size, shuffle=True ) test_dataset = datasets.MNIST( root='D:/PythonCode/Pytorch_learning/MNIST', train=False, download=True, transform=transform ) test_loader = DataLoader( test_dataset, batch_size=batch_size, shuffle=False ) class Net(torch.nn.Module): def __init__(self): super(Net, self).__init__() self.conv1 = torch.nn.Conv2d(1, 10, kernel_size=5) self.conv2 = torch.nn.Conv2d(10, 20, kernel_size=5) self.pooling = torch.nn.MaxPool2d(2) self.fc = torch.nn.Linear(320, 10) def forward(self, x): batch_size = x.size(0) x = F.relu(self.pooling(self.conv1(x))) x = F.relu(self.pooling(self.conv2(x))) x = x.view(batch_size, -1) x = self.fc(x) return x model = Net() criterion = torch.nn.CrossEntropyLoss() optimizer = optim.SGD(model.parameters(), lr=0.01, momentum=0.5) def train(epoch): running_loss = 0.0 for batch_idx, data in enumerate(train_loader, 0): inputs, target = data optimizer.zero_grad() outputs = model(inputs) loss = criterion(outputs, target) loss.backward() optimizer.step() running_loss += loss.item() if batch_idx % 300 == 299: print('[%d, %5d] loss: %.3f' % (epoch + 1, batch_idx + 1, running_loss / 300)) running_loss = 0.0 def test(): correct = 0 total = 0 with torch.no_grad(): for data in test_loader: inputs, labels = data outputs = model(inputs) _, predicted = torch.max(outputs.data, dim = 1) total += labels.size(0) correct += (predicted == labels).sum().item() print('Accuracy on test set: %d %% [%d/%d]' % (100 * correct / total, correct, total)) if __name__ == '__main__': for epoch in range(10): train(epoch) test() æœ¬ç¬”è®°ç³»ç»Ÿæ¢³ç†äº†å·ç§¯ç¥ç»ç½‘ç»œçš„è¾“å…¥ç»“æ„ã€å·ç§¯ä¸æ± åŒ–æ“ä½œçš„åŸç†ã€å‚æ•°è®¾ç½®ã€æ•°å­¦æ¨å¯¼ä¸ä»£ç å®ç°ï¼Œå¹¶é€šè¿‡å…·ä½“çš„ç½‘ç»œç»“æ„æµç¨‹ç¤ºä¾‹ï¼Œå¸®åŠ©ç†è§£CNNçš„æ•´ä½“ä¿¡æ¯æµä¸ç‰¹å¾æå–æœºåˆ¶ã€‚","categories":[{"name":"æ·±åº¦å­¦ä¹ ","slug":"æ·±åº¦å­¦ä¹ ","permalink":"https://toddy110.github.io/categories/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/"}],"tags":[{"name":"æ·±åº¦å­¦ä¹ ","slug":"æ·±åº¦å­¦ä¹ ","permalink":"https://toddy110.github.io/tags/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/"}],"author":"Modesty"}],"categories":[{"name":"æ·±åº¦å­¦ä¹ ","slug":"æ·±åº¦å­¦ä¹ ","permalink":"https://toddy110.github.io/categories/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/"}],"tags":[{"name":"æ·±åº¦å­¦ä¹ ","slug":"æ·±åº¦å­¦ä¹ ","permalink":"https://toddy110.github.io/tags/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/"}]}